/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:523: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:524: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:532: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
04/17/2023 04:16:36 - INFO - __main__ -   Namespace(adam_epsilon=1e-08, add_lang_ids=False, add_task_prefix=False, always_save_model=True, beam_size=10, cache_path='/raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/plbart_csm_2(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/cache_data', config_name='', data_dir='/raid/cs21mtech12001/Research/Notebooks_Dataset/splitted_data/competition_notebooks_with_atleast_1_medal_and_10_votes/with_spacy_summarization/code-with-sm-only', data_num=-1, dev_filename=None, do_eval=False, do_eval_bleu=False, do_lower_case=False, do_test=True, do_train=False, eval_batch_size=8, eval_steps=-1, eval_task='', gradient_accumulation_steps=1, lang='python-notebook', learning_rate=5e-05, load_model_path='/raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-csn/plbart_csn_lr5_bs16_src256_trg128_pat2_e15/checkpoint-best-bleu/pytorch_model.bin', local_rank=-1, log_steps=-1, max_grad_norm=1.0, max_source_length=256, max_steps=-1, max_target_length=128, model_name_or_path='uclanlp/plbart-large', model_type='plbart', no_cuda=False, num_train_epochs=15, output_dir='/raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/plbart_csm_2(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15', patience=2, res_dir='/raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/plbart_csm_2(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/prediction', res_fn='python_notebooks_summarization_PLBART_csm_2', save_last_checkpoints=True, save_steps=-1, seed=1234, start_epoch=0, sub_task='python-notebook', summary_dir='/raid/cs21mtech12001/Research/CodeT5/Repository/summary', task='summarize', test_filename=None, tokenizer_name='uclanlp/plbart-large', train_batch_size=8, train_filename=None, train_steps=-1, warmup_steps=1000, weight_decay=0.0)
04/17/2023 04:16:36 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 96
04/17/2023 04:17:14 - INFO - models -   Finish loading model [406M] from uclanlp/plbart-large
04/17/2023 04:17:14 - INFO - models -   Reload model from /raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-csn/plbart_csn_lr5_bs16_src256_trg128_pat2_e15/checkpoint-best-bleu/pytorch_model.bin
04/17/2023 04:17:32 - INFO - __main__ -     ***** Testing *****
04/17/2023 04:17:32 - INFO - __main__ -     Batch size = 8
04/17/2023 04:17:32 - INFO - __main__ -   Reload model from /raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/plbart_csm_2(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/checkpoint-best-bleu/pytorch_model.bin
04/17/2023 04:17:34 - INFO - utils -   Read 675 examples, avg src len: 55, avg trg len: 5, max src len: 116, max trg len: 13
04/17/2023 04:17:34 - INFO - utils -   Create cache data into /raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/plbart_csm_2(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/cache_data/test_src_all.pt
  0%|          | 0/675 [00:00<?, ?it/s]  5%|▌         | 36/675 [00:00<00:01, 357.95it/s] 11%|█▏        | 76/675 [00:00<00:01, 375.82it/s] 17%|█▋        | 114/675 [00:00<00:01, 367.29it/s] 22%|██▏       | 151/675 [00:00<00:01, 352.21it/s] 28%|██▊       | 187/675 [00:00<00:01, 304.15it/s] 33%|███▎      | 226/675 [00:00<00:01, 325.79it/s] 41%|████      | 274/675 [00:00<00:01, 369.91it/s] 47%|████▋     | 320/675 [00:00<00:00, 395.01it/s] 54%|█████▍    | 366/675 [00:00<00:00, 411.81it/s] 60%|██████    | 408/675 [00:01<00:00, 391.32it/s] 67%|██████▋   | 454/675 [00:01<00:00, 410.50it/s] 74%|███████▍  | 500/675 [00:01<00:00, 419.73it/s] 81%|████████  | 548/675 [00:01<00:00, 433.64it/s] 88%|████████▊ | 596/675 [00:01<00:00, 443.89it/s] 95%|█████████▌| 642/675 [00:01<00:00, 448.53it/s]100%|██████████| 675/675 [00:01<00:00, 399.62it/s]
04/17/2023 04:17:36 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
04/17/2023 04:17:36 - INFO - __main__ -     Num examples = 675
04/17/2023 04:17:36 - INFO - __main__ -     Batch size = 8
Eval bleu for test set:   0%|          | 0/85 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/85 [00:00<01:22,  1.02it/s]Eval bleu for test set:   2%|▏         | 2/85 [00:01<00:48,  1.71it/s]Eval bleu for test set:   4%|▎         | 3/85 [00:01<00:39,  2.07it/s]Eval bleu for test set:   5%|▍         | 4/85 [00:01<00:33,  2.45it/s]Eval bleu for test set:   6%|▌         | 5/85 [00:02<00:29,  2.68it/s]Eval bleu for test set:   7%|▋         | 6/85 [00:02<00:28,  2.78it/s]Eval bleu for test set:   8%|▊         | 7/85 [00:02<00:26,  2.92it/s]Eval bleu for test set:   9%|▉         | 8/85 [00:03<00:25,  3.00it/s]Eval bleu for test set:  11%|█         | 9/85 [00:03<00:23,  3.18it/s]Eval bleu for test set:  12%|█▏        | 10/85 [00:03<00:22,  3.31it/s]Eval bleu for test set:  13%|█▎        | 11/85 [00:04<00:22,  3.32it/s]Eval bleu for test set:  14%|█▍        | 12/85 [00:04<00:22,  3.28it/s]Eval bleu for test set:  15%|█▌        | 13/85 [00:04<00:21,  3.32it/s]Eval bleu for test set:  16%|█▋        | 14/85 [00:04<00:21,  3.28it/s]Eval bleu for test set:  18%|█▊        | 15/85 [00:05<00:22,  3.07it/s]Eval bleu for test set:  19%|█▉        | 16/85 [00:05<00:22,  3.11it/s]Eval bleu for test set:  20%|██        | 17/85 [00:06<00:23,  2.93it/s]Eval bleu for test set:  21%|██        | 18/85 [00:06<00:22,  2.99it/s]Eval bleu for test set:  22%|██▏       | 19/85 [00:06<00:21,  3.03it/s]Eval bleu for test set:  24%|██▎       | 20/85 [00:06<00:20,  3.14it/s]Eval bleu for test set:  25%|██▍       | 21/85 [00:07<00:20,  3.16it/s]Eval bleu for test set:  26%|██▌       | 22/85 [00:07<00:20,  3.11it/s]Eval bleu for test set:  27%|██▋       | 23/85 [00:07<00:20,  3.02it/s]Eval bleu for test set:  28%|██▊       | 24/85 [00:08<00:20,  2.97it/s]Eval bleu for test set:  29%|██▉       | 25/85 [00:08<00:19,  3.03it/s]Eval bleu for test set:  31%|███       | 26/85 [00:08<00:18,  3.14it/s]Eval bleu for test set:  32%|███▏      | 27/85 [00:09<00:18,  3.14it/s]Eval bleu for test set:  33%|███▎      | 28/85 [00:09<00:19,  3.00it/s]Eval bleu for test set:  34%|███▍      | 29/85 [00:09<00:18,  2.99it/s]Eval bleu for test set:  35%|███▌      | 30/85 [00:10<00:18,  3.04it/s]Eval bleu for test set:  36%|███▋      | 31/85 [00:10<00:17,  3.09it/s]Eval bleu for test set:  38%|███▊      | 32/85 [00:10<00:16,  3.17it/s]Eval bleu for test set:  39%|███▉      | 33/85 [00:11<00:16,  3.23it/s]Eval bleu for test set:  40%|████      | 34/85 [00:11<00:16,  3.08it/s]Eval bleu for test set:  41%|████      | 35/85 [00:11<00:16,  3.12it/s]Eval bleu for test set:  42%|████▏     | 36/85 [00:12<00:16,  2.98it/s]Eval bleu for test set:  44%|████▎     | 37/85 [00:12<00:16,  2.97it/s]Eval bleu for test set:  45%|████▍     | 38/85 [00:12<00:15,  2.98it/s]Eval bleu for test set:  46%|████▌     | 39/85 [00:13<00:16,  2.87it/s]Eval bleu for test set:  47%|████▋     | 40/85 [00:13<00:15,  3.00it/s]Eval bleu for test set:  48%|████▊     | 41/85 [00:14<00:16,  2.62it/s]Eval bleu for test set:  49%|████▉     | 42/85 [00:14<00:15,  2.76it/s]Eval bleu for test set:  51%|█████     | 43/85 [00:14<00:15,  2.70it/s]Eval bleu for test set:  52%|█████▏    | 44/85 [00:15<00:14,  2.75it/s]Eval bleu for test set:  53%|█████▎    | 45/85 [00:15<00:13,  2.92it/s]Eval bleu for test set:  54%|█████▍    | 46/85 [00:15<00:13,  2.99it/s]Eval bleu for test set:  55%|█████▌    | 47/85 [00:16<00:12,  3.11it/s]Eval bleu for test set:  56%|█████▋    | 48/85 [00:16<00:12,  3.02it/s]Eval bleu for test set:  58%|█████▊    | 49/85 [00:16<00:12,  2.85it/s]Eval bleu for test set:  59%|█████▉    | 50/85 [00:17<00:12,  2.82it/s]Eval bleu for test set:  60%|██████    | 51/85 [00:17<00:11,  2.91it/s]Eval bleu for test set:  61%|██████    | 52/85 [00:17<00:11,  2.89it/s]Eval bleu for test set:  62%|██████▏   | 53/85 [00:18<00:11,  2.67it/s]Eval bleu for test set:  64%|██████▎   | 54/85 [00:18<00:11,  2.81it/s]Eval bleu for test set:  65%|██████▍   | 55/85 [00:18<00:11,  2.68it/s]Eval bleu for test set:  66%|██████▌   | 56/85 [00:19<00:10,  2.82it/s]Eval bleu for test set:  67%|██████▋   | 57/85 [00:19<00:10,  2.61it/s]Eval bleu for test set:  68%|██████▊   | 58/85 [00:20<00:09,  2.80it/s]Eval bleu for test set:  69%|██████▉   | 59/85 [00:20<00:08,  2.90it/s]Eval bleu for test set:  71%|███████   | 60/85 [00:20<00:08,  2.94it/s]Eval bleu for test set:  72%|███████▏  | 61/85 [00:21<00:08,  2.76it/s]Eval bleu for test set:  73%|███████▎  | 62/85 [00:21<00:08,  2.82it/s]Eval bleu for test set:  74%|███████▍  | 63/85 [00:21<00:07,  2.92it/s]Eval bleu for test set:  75%|███████▌  | 64/85 [00:22<00:06,  3.06it/s]Eval bleu for test set:  76%|███████▋  | 65/85 [00:22<00:06,  3.13it/s]Eval bleu for test set:  78%|███████▊  | 66/85 [00:22<00:06,  3.11it/s]Eval bleu for test set:  79%|███████▉  | 67/85 [00:22<00:05,  3.07it/s]Eval bleu for test set:  80%|████████  | 68/85 [00:23<00:05,  2.97it/s]Eval bleu for test set:  81%|████████  | 69/85 [00:23<00:05,  2.95it/s]Eval bleu for test set:  82%|████████▏ | 70/85 [00:24<00:05,  2.87it/s]Eval bleu for test set:  84%|████████▎ | 71/85 [00:24<00:05,  2.68it/s]Eval bleu for test set:  85%|████████▍ | 72/85 [00:24<00:04,  2.69it/s]Eval bleu for test set:  86%|████████▌ | 73/85 [00:25<00:04,  2.56it/s]Eval bleu for test set:  87%|████████▋ | 74/85 [00:25<00:04,  2.48it/s]Eval bleu for test set:  88%|████████▊ | 75/85 [00:26<00:04,  2.39it/s]Eval bleu for test set:  89%|████████▉ | 76/85 [00:26<00:03,  2.42it/s]Eval bleu for test set:  91%|█████████ | 77/85 [00:26<00:03,  2.52it/s]Eval bleu for test set:  92%|█████████▏| 78/85 [00:27<00:02,  2.61it/s]Eval bleu for test set:  93%|█████████▎| 79/85 [00:27<00:02,  2.66it/s]Eval bleu for test set:  94%|█████████▍| 80/85 [00:28<00:01,  2.72it/s]Eval bleu for test set:  95%|█████████▌| 81/85 [00:28<00:01,  2.72it/s]Eval bleu for test set:  96%|█████████▋| 82/85 [00:28<00:01,  2.70it/s]Eval bleu for test set:  98%|█████████▊| 83/85 [00:29<00:00,  2.74it/s]Eval bleu for test set:  99%|█████████▉| 84/85 [00:29<00:00,  2.71it/s]Eval bleu for test set: 100%|██████████| 85/85 [00:29<00:00,  3.05it/s]Eval bleu for test set: 100%|██████████| 85/85 [00:29<00:00,  2.85it/s]
Total: 675
04/17/2023 04:18:06 - INFO - __main__ -   ***** Eval results *****
04/17/2023 04:18:06 - INFO - __main__ -     bleu = 19.58
04/17/2023 04:18:06 - INFO - __main__ -     em = 1.4815
04/17/2023 04:18:06 - INFO - __main__ -   [best-bleu] bleu-4: 19.58, em: 1.4815, codebleu: 0.0000

04/17/2023 04:18:06 - INFO - __main__ -   Finish and take 1m
