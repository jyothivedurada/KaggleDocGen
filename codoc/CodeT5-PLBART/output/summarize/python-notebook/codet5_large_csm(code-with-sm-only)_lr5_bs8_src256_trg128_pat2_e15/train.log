/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:523: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:524: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/raid/cs21mtech12001/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:532: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
03/27/2023 00:31:13 - INFO - __main__ -   Namespace(adam_epsilon=1e-08, add_lang_ids=False, add_task_prefix=False, always_save_model=True, beam_size=10, cache_path='/raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/codet5_large_csm(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/cache_data', config_name='', data_dir='/raid/cs21mtech12001/Research/Notebooks_Dataset/splitted_data/competition_notebooks_with_atleast_1_medal_and_10_votes/with_spacy_summarization/code-with-sm-only', data_num=-1, dev_filename=None, do_eval=False, do_eval_bleu=False, do_lower_case=False, do_test=True, do_train=False, eval_batch_size=8, eval_steps=-1, eval_task='', gradient_accumulation_steps=1, lang='python-notebook', learning_rate=5e-05, load_model_path='/raid/cs21mtech12001/Research/CodeT5/Repository/finetuned_checkpoints/summarize_python_codet5_large.bin', local_rank=-1, log_steps=-1, max_grad_norm=1.0, max_source_length=256, max_steps=-1, max_target_length=128, model_name_or_path='Salesforce/codet5-large', model_type='codet5', no_cuda=False, num_train_epochs=15, output_dir='/raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/codet5_large_csm(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15', patience=2, res_dir='/raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/codet5_large_csm(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/prediction', res_fn='python_notebooks_summarization_CodeT5_large_csm', save_last_checkpoints=True, save_steps=-1, seed=1234, start_epoch=0, sub_task='python-notebook', summary_dir='/raid/cs21mtech12001/Research/CodeT5/Repository/summary', task='summarize', test_filename=None, tokenizer_name='Salesforce/codet5-large', train_batch_size=8, train_filename=None, train_steps=-1, warmup_steps=1000, weight_decay=0.0)
03/27/2023 00:31:13 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 96
03/27/2023 00:31:30 - INFO - models -   Finish loading model [738M] from Salesforce/codet5-large
03/27/2023 00:31:30 - INFO - models -   Reload model from /raid/cs21mtech12001/Research/CodeT5/Repository/finetuned_checkpoints/summarize_python_codet5_large.bin
03/27/2023 00:31:46 - INFO - __main__ -     ***** Testing *****
03/27/2023 00:31:46 - INFO - __main__ -     Batch size = 8
03/27/2023 00:31:46 - INFO - __main__ -   Reload model from /raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/codet5_large_csm(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/checkpoint-best-bleu/pytorch_model.bin
03/27/2023 00:31:48 - INFO - utils -   Read 675 examples, avg src len: 55, avg trg len: 5, max src len: 116, max trg len: 13
03/27/2023 00:31:48 - INFO - utils -   Create cache data into /raid/cs21mtech12001/Research/CodeT5/Repository/output/summarize/python-notebook/codet5_large_csm(code-with-sm-only)_lr5_bs8_src256_trg128_pat2_e15/cache_data/test_src_all.pt
  0%|          | 0/675 [00:00<?, ?it/s]  1%|          | 4/675 [00:00<00:16, 39.74it/s]  2%|▏         | 12/675 [00:00<00:12, 54.62it/s]  3%|▎         | 18/675 [00:00<00:11, 56.84it/s]  4%|▍         | 26/675 [00:00<00:10, 59.76it/s]  5%|▌         | 34/675 [00:00<00:10, 60.73it/s]  6%|▌         | 42/675 [00:00<00:10, 61.77it/s]  7%|▋         | 50/675 [00:00<00:09, 62.98it/s]  9%|▊         | 58/675 [00:00<00:09, 63.83it/s] 10%|▉         | 66/675 [00:01<00:09, 64.12it/s] 11%|█         | 73/675 [00:01<00:09, 60.60it/s] 12%|█▏        | 80/675 [00:01<00:09, 61.05it/s] 13%|█▎        | 88/675 [00:01<00:09, 65.10it/s] 15%|█▍        | 98/675 [00:01<00:08, 70.20it/s] 16%|█▌        | 106/675 [00:01<00:07, 72.29it/s] 17%|█▋        | 114/675 [00:01<00:07, 72.66it/s] 18%|█▊        | 122/675 [00:01<00:07, 73.54it/s] 19%|█▉        | 130/675 [00:01<00:07, 74.02it/s] 20%|██        | 138/675 [00:02<00:07, 74.18it/s] 22%|██▏       | 146/675 [00:02<00:07, 74.02it/s] 23%|██▎       | 154/675 [00:02<00:07, 73.85it/s] 24%|██▍       | 162/675 [00:02<00:07, 72.85it/s] 25%|██▌       | 170/675 [00:02<00:07, 71.23it/s] 26%|██▋       | 178/675 [00:02<00:07, 70.63it/s] 28%|██▊       | 186/675 [00:02<00:07, 66.59it/s] 29%|██▊       | 193/675 [00:02<00:07, 65.78it/s] 30%|██▉       | 200/675 [00:03<00:08, 58.29it/s] 31%|███       | 208/675 [00:03<00:07, 62.83it/s] 32%|███▏      | 216/675 [00:03<00:06, 65.75it/s] 33%|███▎      | 224/675 [00:03<00:06, 69.39it/s] 34%|███▍      | 232/675 [00:03<00:06, 71.80it/s] 36%|███▌      | 240/675 [00:03<00:05, 73.67it/s] 37%|███▋      | 248/675 [00:03<00:05, 75.47it/s] 38%|███▊      | 256/675 [00:03<00:05, 75.90it/s] 39%|███▉      | 264/675 [00:03<00:05, 76.84it/s] 40%|████      | 272/675 [00:03<00:05, 76.79it/s] 42%|████▏     | 282/675 [00:04<00:05, 78.03it/s] 43%|████▎     | 292/675 [00:04<00:04, 78.12it/s] 45%|████▍     | 302/675 [00:04<00:04, 78.77it/s] 46%|████▌     | 312/675 [00:04<00:04, 79.24it/s] 47%|████▋     | 320/675 [00:04<00:04, 79.38it/s] 49%|████▊     | 328/675 [00:04<00:04, 79.27it/s] 50%|█████     | 338/675 [00:04<00:04, 80.43it/s] 51%|█████▏    | 347/675 [00:04<00:04, 76.40it/s] 53%|█████▎    | 356/675 [00:05<00:04, 76.26it/s] 54%|█████▍    | 366/675 [00:05<00:03, 79.03it/s] 56%|█████▌    | 376/675 [00:05<00:03, 80.99it/s] 57%|█████▋    | 386/675 [00:05<00:03, 81.72it/s] 59%|█████▊    | 396/675 [00:05<00:03, 80.05it/s] 60%|██████    | 405/675 [00:05<00:03, 82.20it/s] 61%|██████▏   | 414/675 [00:05<00:03, 78.92it/s] 63%|██████▎   | 424/675 [00:05<00:03, 80.05it/s] 64%|██████▍   | 434/675 [00:06<00:02, 80.77it/s] 66%|██████▌   | 443/675 [00:06<00:02, 82.60it/s] 67%|██████▋   | 452/675 [00:06<00:02, 78.30it/s] 68%|██████▊   | 460/675 [00:06<00:02, 78.17it/s] 69%|██████▉   | 468/675 [00:06<00:02, 78.06it/s] 71%|███████   | 476/675 [00:06<00:02, 78.30it/s] 72%|███████▏  | 486/675 [00:06<00:02, 79.03it/s] 73%|███████▎  | 496/675 [00:06<00:02, 80.35it/s] 75%|███████▍  | 505/675 [00:06<00:02, 82.27it/s] 76%|███████▌  | 514/675 [00:07<00:01, 80.62it/s] 78%|███████▊  | 524/675 [00:07<00:01, 81.37it/s] 79%|███████▉  | 534/675 [00:07<00:01, 82.15it/s] 81%|████████  | 544/675 [00:07<00:01, 83.44it/s] 82%|████████▏ | 554/675 [00:07<00:01, 84.09it/s] 84%|████████▎ | 564/675 [00:07<00:01, 84.63it/s] 85%|████████▍ | 573/675 [00:07<00:01, 85.87it/s] 86%|████████▌ | 582/675 [00:07<00:01, 80.09it/s] 88%|████████▊ | 591/675 [00:07<00:01, 81.61it/s] 89%|████████▉ | 600/675 [00:08<00:01, 71.64it/s] 90%|█████████ | 608/675 [00:08<00:00, 72.75it/s] 91%|█████████▏| 616/675 [00:08<00:00, 73.30it/s] 92%|█████████▏| 624/675 [00:08<00:00, 69.82it/s] 94%|█████████▍| 634/675 [00:08<00:00, 73.28it/s] 95%|█████████▌| 642/675 [00:08<00:00, 71.81it/s] 97%|█████████▋| 652/675 [00:08<00:00, 73.86it/s] 98%|█████████▊| 660/675 [00:08<00:00, 74.48it/s] 99%|█████████▉| 670/675 [00:09<00:00, 77.40it/s]100%|██████████| 675/675 [00:09<00:00, 74.27it/s]
03/27/2023 00:31:57 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
03/27/2023 00:31:57 - INFO - __main__ -     Num examples = 675
03/27/2023 00:31:57 - INFO - __main__ -     Batch size = 8
Eval bleu for test set:   0%|          | 0/85 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/85 [00:01<02:33,  1.82s/it]Eval bleu for test set:   2%|▏         | 2/85 [00:02<01:42,  1.24s/it]Eval bleu for test set:   4%|▎         | 3/85 [00:03<01:24,  1.03s/it]Eval bleu for test set:   5%|▍         | 4/85 [00:04<01:12,  1.11it/s]Eval bleu for test set:   6%|▌         | 5/85 [00:04<01:07,  1.19it/s]Eval bleu for test set:   7%|▋         | 6/85 [00:05<01:03,  1.24it/s]Eval bleu for test set:   8%|▊         | 7/85 [00:06<01:03,  1.24it/s]Eval bleu for test set:   9%|▉         | 8/85 [00:07<01:00,  1.27it/s]Eval bleu for test set:  11%|█         | 9/85 [00:07<00:58,  1.31it/s]Eval bleu for test set:  12%|█▏        | 10/85 [00:08<00:55,  1.34it/s]Eval bleu for test set:  13%|█▎        | 11/85 [00:09<00:57,  1.29it/s]Eval bleu for test set:  14%|█▍        | 12/85 [00:10<01:00,  1.22it/s]Eval bleu for test set:  15%|█▌        | 13/85 [00:11<00:56,  1.27it/s]Eval bleu for test set:  16%|█▋        | 14/85 [00:11<00:55,  1.28it/s]Eval bleu for test set:  18%|█▊        | 15/85 [00:12<00:58,  1.20it/s]Eval bleu for test set:  19%|█▉        | 16/85 [00:13<00:56,  1.22it/s]Eval bleu for test set:  20%|██        | 17/85 [00:14<00:56,  1.20it/s]Eval bleu for test set:  21%|██        | 18/85 [00:15<00:53,  1.24it/s]Eval bleu for test set:  22%|██▏       | 19/85 [00:15<00:51,  1.27it/s]Eval bleu for test set:  24%|██▎       | 20/85 [00:16<00:50,  1.29it/s]Eval bleu for test set:  25%|██▍       | 21/85 [00:17<00:47,  1.35it/s]Eval bleu for test set:  26%|██▌       | 22/85 [00:18<00:46,  1.35it/s]Eval bleu for test set:  27%|██▋       | 23/85 [00:19<00:51,  1.21it/s]Eval bleu for test set:  28%|██▊       | 24/85 [00:19<00:49,  1.23it/s]Eval bleu for test set:  29%|██▉       | 25/85 [00:20<00:49,  1.20it/s]Eval bleu for test set:  31%|███       | 26/85 [00:21<00:46,  1.26it/s]Eval bleu for test set:  32%|███▏      | 27/85 [00:22<00:45,  1.28it/s]Eval bleu for test set:  33%|███▎      | 28/85 [00:28<02:11,  2.30s/it]Eval bleu for test set:  34%|███▍      | 29/85 [00:28<01:44,  1.87s/it]Eval bleu for test set:  35%|███▌      | 30/85 [00:29<01:23,  1.52s/it]Eval bleu for test set:  36%|███▋      | 31/85 [00:30<01:10,  1.31s/it]Eval bleu for test set:  38%|███▊      | 32/85 [00:31<00:59,  1.12s/it]Eval bleu for test set:  39%|███▉      | 33/85 [00:31<00:52,  1.00s/it]Eval bleu for test set:  40%|████      | 34/85 [00:32<00:46,  1.09it/s]Eval bleu for test set:  41%|████      | 35/85 [00:33<00:44,  1.11it/s]Eval bleu for test set:  42%|████▏     | 36/85 [00:34<00:42,  1.14it/s]Eval bleu for test set:  44%|████▎     | 37/85 [00:34<00:39,  1.21it/s]Eval bleu for test set:  45%|████▍     | 38/85 [00:35<00:39,  1.18it/s]Eval bleu for test set:  46%|████▌     | 39/85 [00:36<00:38,  1.19it/s]Eval bleu for test set:  47%|████▋     | 40/85 [00:37<00:36,  1.24it/s]Eval bleu for test set:  48%|████▊     | 41/85 [00:38<00:36,  1.21it/s]Eval bleu for test set:  49%|████▉     | 42/85 [00:38<00:34,  1.25it/s]Eval bleu for test set:  51%|█████     | 43/85 [00:39<00:33,  1.24it/s]Eval bleu for test set:  52%|█████▏    | 44/85 [00:40<00:33,  1.23it/s]Eval bleu for test set:  53%|█████▎    | 45/85 [00:41<00:32,  1.23it/s]Eval bleu for test set:  54%|█████▍    | 46/85 [00:42<00:34,  1.12it/s]Eval bleu for test set:  55%|█████▌    | 47/85 [00:43<00:31,  1.20it/s]Eval bleu for test set:  56%|█████▋    | 48/85 [00:43<00:29,  1.24it/s]Eval bleu for test set:  58%|█████▊    | 49/85 [00:44<00:29,  1.21it/s]Eval bleu for test set:  59%|█████▉    | 50/85 [00:45<00:28,  1.25it/s]Eval bleu for test set:  60%|██████    | 51/85 [00:46<00:26,  1.28it/s]Eval bleu for test set:  61%|██████    | 52/85 [00:47<00:26,  1.24it/s]Eval bleu for test set:  62%|██████▏   | 53/85 [00:47<00:25,  1.25it/s]Eval bleu for test set:  64%|██████▎   | 54/85 [00:48<00:25,  1.22it/s]Eval bleu for test set:  65%|██████▍   | 55/85 [00:49<00:24,  1.20it/s]Eval bleu for test set:  66%|██████▌   | 56/85 [00:50<00:24,  1.18it/s]Eval bleu for test set:  67%|██████▋   | 57/85 [00:51<00:24,  1.13it/s]Eval bleu for test set:  68%|██████▊   | 58/85 [00:52<00:23,  1.13it/s]Eval bleu for test set:  69%|██████▉   | 59/85 [00:53<00:21,  1.20it/s]Eval bleu for test set:  71%|███████   | 60/85 [00:53<00:20,  1.24it/s]Eval bleu for test set:  72%|███████▏  | 61/85 [00:54<00:21,  1.13it/s]Eval bleu for test set:  73%|███████▎  | 62/85 [00:55<00:18,  1.22it/s]Eval bleu for test set:  74%|███████▍  | 63/85 [00:56<00:17,  1.26it/s]Eval bleu for test set:  75%|███████▌  | 64/85 [00:57<00:16,  1.25it/s]Eval bleu for test set:  76%|███████▋  | 65/85 [00:57<00:15,  1.31it/s]Eval bleu for test set:  78%|███████▊  | 66/85 [00:58<00:14,  1.29it/s]Eval bleu for test set:  79%|███████▉  | 67/85 [00:59<00:13,  1.30it/s]Eval bleu for test set:  80%|████████  | 68/85 [01:00<00:13,  1.23it/s]Eval bleu for test set:  81%|████████  | 69/85 [01:01<00:12,  1.25it/s]Eval bleu for test set:  82%|████████▏ | 70/85 [01:01<00:11,  1.26it/s]Eval bleu for test set:  84%|████████▎ | 71/85 [01:02<00:11,  1.24it/s]Eval bleu for test set:  85%|████████▍ | 72/85 [01:03<00:10,  1.25it/s]Eval bleu for test set:  86%|████████▌ | 73/85 [01:04<00:09,  1.23it/s]Eval bleu for test set:  87%|████████▋ | 74/85 [01:05<00:08,  1.27it/s]Eval bleu for test set:  88%|████████▊ | 75/85 [01:05<00:08,  1.23it/s]Eval bleu for test set:  89%|████████▉ | 76/85 [01:06<00:07,  1.22it/s]Eval bleu for test set:  91%|█████████ | 77/85 [01:07<00:06,  1.25it/s]Eval bleu for test set:  92%|█████████▏| 78/85 [01:08<00:05,  1.28it/s]Eval bleu for test set:  93%|█████████▎| 79/85 [01:09<00:04,  1.28it/s]Eval bleu for test set:  94%|█████████▍| 80/85 [01:09<00:03,  1.32it/s]Eval bleu for test set:  95%|█████████▌| 81/85 [01:10<00:03,  1.32it/s]Eval bleu for test set:  96%|█████████▋| 82/85 [01:11<00:02,  1.31it/s]Eval bleu for test set:  98%|█████████▊| 83/85 [01:12<00:01,  1.25it/s]Eval bleu for test set:  99%|█████████▉| 84/85 [01:13<00:00,  1.16it/s]Eval bleu for test set: 100%|██████████| 85/85 [01:13<00:00,  1.36it/s]Eval bleu for test set: 100%|██████████| 85/85 [01:13<00:00,  1.15it/s]
Total: 675
03/27/2023 00:33:14 - INFO - __main__ -   ***** Eval results *****
03/27/2023 00:33:14 - INFO - __main__ -     bleu = 21.64
03/27/2023 00:33:14 - INFO - __main__ -     em = 5.7778
03/27/2023 00:33:14 - INFO - __main__ -   [best-bleu] bleu-4: 21.64, em: 5.7778, codebleu: 0.0000

03/27/2023 00:33:14 - INFO - __main__ -   Finish and take 2m
