10/21/2022 04:38:58 - INFO - __main__ -   Namespace(adam_epsilon=1e-08, beam_size=10, config_name='microsoft/graphcodebert-base', dev_filename='/raid/cs21mtech12001/Research/Notebooks_Dataset/splitted_data/competition_notebooks_with_atleast_1_medal_and_10_votes/with_spacy_summarization/all_constraints/todo-18/valid_dataset.jsonl', do_eval=False, do_lower_case=False, do_test=True, do_train=False, eval_batch_size=32, eval_steps=-1, gradient_accumulation_steps=1, learning_rate=5e-05, load_model_path='/raid/cs21mtech12001/Research/CodeBERT/Repository/GraphCodeBERT/code-summarization/output/notebooks/with_spacy_summarization/all_constraints/todo-18-with-CSN/checkpoint-best-bleu/pytorch_model.bin', local_rank=-1, max_grad_norm=1.0, max_source_length=320, max_steps=-1, max_target_length=256, model_name_or_path='microsoft/graphcodebert-base', model_type='roberta', no_cuda=False, num_train_epochs=3, output_dir='/raid/cs21mtech12001/Research/CodeBERT/Repository/GraphCodeBERT/code-summarization/output/notebooks/with_spacy_summarization/all_constraints/todo-18-with-CSN', seed=42, test_filename='/raid/cs21mtech12001/Research/Notebooks_Dataset/splitted_data/competition_notebooks_with_atleast_1_medal_and_10_votes/with_spacy_summarization/all_constraints/todo-18/test_dataset.jsonl', tokenizer_name='microsoft/graphcodebert-base', train_batch_size=8, train_filename=None, train_steps=-1, warmup_steps=0, weight_decay=0.0)
Some weights of the model checkpoint at microsoft/graphcodebert-base were not used when initializing RobertaModel: ['lm_head.dense.weight', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.layer_norm.weight', 'lm_head.decoder.bias', 'lm_head.dense.bias', 'lm_head.layer_norm.bias']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaModel were not initialized from the model checkpoint at microsoft/graphcodebert-base and are newly initialized: ['roberta.pooler.dense.weight', 'roberta.pooler.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
10/21/2022 04:39:08 - INFO - __main__ -   reload model from /raid/cs21mtech12001/Research/CodeBERT/Repository/GraphCodeBERT/code-summarization/output/notebooks/with_spacy_summarization/all_constraints/todo-18-with-CSN/checkpoint-best-bleu/pytorch_model.bin
10/21/2022 04:39:13 - INFO - __main__ -   Test file: /raid/cs21mtech12001/Research/Notebooks_Dataset/splitted_data/competition_notebooks_with_atleast_1_medal_and_10_votes/with_spacy_summarization/all_constraints/todo-18/valid_dataset.jsonl
  0%|          | 0/1821 [00:00<?, ?it/s]  2%|▏         | 28/1821 [00:00<00:06, 275.31it/s]  3%|▎         | 56/1821 [00:00<00:06, 277.68it/s]  5%|▍         | 84/1821 [00:00<00:06, 278.65it/s]  6%|▌         | 112/1821 [00:00<00:06, 261.30it/s]  8%|▊         | 143/1821 [00:00<00:06, 273.79it/s]  9%|▉         | 171/1821 [00:00<00:06, 258.96it/s] 11%|█         | 198/1821 [00:00<00:06, 257.05it/s] 12%|█▏        | 224/1821 [00:00<00:06, 257.36it/s] 14%|█▍        | 257/1821 [00:00<00:05, 276.47it/s] 16%|█▌        | 285/1821 [00:01<00:05, 270.65it/s] 18%|█▊        | 324/1821 [00:01<00:04, 305.47it/s] 19%|█▉        | 355/1821 [00:01<00:04, 302.07it/s] 21%|██▏       | 387/1821 [00:01<00:04, 306.23it/s] 23%|██▎       | 418/1821 [00:01<00:04, 302.53it/s] 25%|██▍       | 449/1821 [00:01<00:04, 284.18it/s] 26%|██▌       | 478/1821 [00:01<00:04, 283.18it/s] 28%|██▊       | 507/1821 [00:01<00:04, 272.12it/s] 29%|██▉       | 535/1821 [00:01<00:04, 260.29it/s] 31%|███       | 562/1821 [00:02<00:05, 241.97it/s] 32%|███▏      | 587/1821 [00:02<00:05, 233.01it/s] 34%|███▎      | 614/1821 [00:02<00:04, 242.57it/s] 35%|███▌      | 642/1821 [00:02<00:04, 251.49it/s] 37%|███▋      | 671/1821 [00:02<00:04, 259.92it/s] 38%|███▊      | 701/1821 [00:02<00:04, 269.02it/s] 40%|████      | 729/1821 [00:02<00:04, 233.83it/s] 41%|████▏     | 754/1821 [00:02<00:04, 213.93it/s] 43%|████▎     | 781/1821 [00:03<00:04, 226.45it/s] 45%|████▍     | 813/1821 [00:03<00:04, 250.98it/s] 46%|████▌     | 842/1821 [00:03<00:03, 261.51it/s] 48%|████▊     | 874/1821 [00:03<00:03, 276.77it/s] 50%|████▉     | 903/1821 [00:03<00:03, 271.26it/s] 51%|█████     | 932/1821 [00:03<00:03, 275.92it/s] 53%|█████▎    | 964/1821 [00:03<00:02, 288.44it/s] 55%|█████▍    | 994/1821 [00:03<00:02, 277.26it/s] 56%|█████▌    | 1023/1821 [00:03<00:02, 274.21it/s] 58%|█████▊    | 1064/1821 [00:03<00:02, 311.92it/s] 60%|██████    | 1096/1821 [00:04<00:02, 295.28it/s] 62%|██████▏   | 1126/1821 [00:04<00:02, 285.94it/s] 63%|██████▎   | 1155/1821 [00:04<00:03, 214.79it/s] 65%|██████▌   | 1184/1821 [00:04<00:02, 231.37it/s] 67%|██████▋   | 1211/1821 [00:04<00:02, 239.66it/s] 68%|██████▊   | 1237/1821 [00:04<00:02, 238.10it/s] 70%|██████▉   | 1266/1821 [00:04<00:02, 250.40it/s] 71%|███████   | 1293/1821 [00:04<00:02, 248.74it/s] 72%|███████▏  | 1319/1821 [00:05<00:02, 245.58it/s] 74%|███████▍  | 1345/1821 [00:05<00:01, 246.79it/s] 75%|███████▌  | 1371/1821 [00:05<00:01, 247.22it/s] 77%|███████▋  | 1396/1821 [00:05<00:01, 241.55it/s] 78%|███████▊  | 1423/1821 [00:05<00:01, 248.28it/s] 80%|███████▉  | 1453/1821 [00:05<00:01, 262.75it/s] 81%|████████▏ | 1480/1821 [00:05<00:01, 261.00it/s] 83%|████████▎ | 1507/1821 [00:05<00:01, 247.59it/s] 84%|████████▍ | 1532/1821 [00:05<00:01, 238.88it/s] 86%|████████▌ | 1562/1821 [00:05<00:01, 254.66it/s] 87%|████████▋ | 1588/1821 [00:06<00:00, 249.38it/s] 89%|████████▊ | 1614/1821 [00:06<00:00, 239.33it/s] 90%|█████████ | 1639/1821 [00:06<00:00, 234.05it/s] 91%|█████████▏| 1663/1821 [00:06<00:00, 227.26it/s] 93%|█████████▎| 1691/1821 [00:06<00:00, 240.17it/s] 95%|█████████▍| 1727/1821 [00:06<00:00, 272.03it/s] 96%|█████████▋| 1756/1821 [00:06<00:00, 275.93it/s] 98%|█████████▊| 1785/1821 [00:06<00:00, 279.15it/s]100%|█████████▉| 1817/1821 [00:06<00:00, 288.76it/s]100%|██████████| 1821/1821 [00:06<00:00, 260.98it/s]
  0%|          | 0/57 [00:00<?, ?it/s]/raid/cs21mtech12001/Research/CodeBERT/Repository/GraphCodeBERT/code-summarization/model.py:175: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  prevK = bestScoresId // numWords
  2%|▏         | 1/57 [00:10<09:31, 10.21s/it]  4%|▎         | 2/57 [00:12<04:50,  5.28s/it]  5%|▌         | 3/57 [00:13<03:14,  3.60s/it]  7%|▋         | 4/57 [00:15<02:29,  2.83s/it]  9%|▉         | 5/57 [00:16<02:03,  2.38s/it] 11%|█         | 6/57 [00:18<01:50,  2.16s/it] 12%|█▏        | 7/57 [00:20<01:43,  2.07s/it] 14%|█▍        | 8/57 [00:22<01:40,  2.05s/it] 16%|█▌        | 9/57 [00:24<01:33,  1.94s/it] 18%|█▊        | 10/57 [00:25<01:27,  1.86s/it] 19%|█▉        | 11/57 [00:27<01:22,  1.79s/it] 21%|██        | 12/57 [00:29<01:17,  1.73s/it] 23%|██▎       | 13/57 [00:30<01:14,  1.70s/it] 25%|██▍       | 14/57 [00:32<01:13,  1.70s/it] 26%|██▋       | 15/57 [00:34<01:09,  1.66s/it] 28%|██▊       | 16/57 [00:35<01:07,  1.64s/it] 30%|██▉       | 17/57 [00:37<01:07,  1.69s/it] 32%|███▏      | 18/57 [00:39<01:06,  1.70s/it] 33%|███▎      | 19/57 [00:40<01:05,  1.74s/it] 35%|███▌      | 20/57 [00:42<01:02,  1.70s/it] 37%|███▋      | 21/57 [00:44<01:00,  1.69s/it] 39%|███▊      | 22/57 [00:46<01:00,  1.72s/it] 40%|████      | 23/57 [00:47<01:01,  1.80s/it] 42%|████▏     | 24/57 [00:49<01:00,  1.83s/it] 44%|████▍     | 25/57 [00:51<00:54,  1.71s/it] 46%|████▌     | 26/57 [00:52<00:52,  1.70s/it] 47%|████▋     | 27/57 [00:54<00:50,  1.70s/it] 49%|████▉     | 28/57 [00:56<00:51,  1.79s/it] 51%|█████     | 29/57 [00:58<00:48,  1.73s/it] 53%|█████▎    | 30/57 [01:00<00:48,  1.80s/it] 54%|█████▍    | 31/57 [01:01<00:46,  1.77s/it] 56%|█████▌    | 32/57 [01:03<00:43,  1.76s/it] 58%|█████▊    | 33/57 [01:05<00:40,  1.70s/it] 60%|█████▉    | 34/57 [01:06<00:38,  1.67s/it] 61%|██████▏   | 35/57 [01:08<00:37,  1.68s/it] 63%|██████▎   | 36/57 [01:10<00:35,  1.68s/it] 65%|██████▍   | 37/57 [01:12<00:34,  1.72s/it] 67%|██████▋   | 38/57 [01:13<00:31,  1.67s/it] 68%|██████▊   | 39/57 [01:15<00:30,  1.68s/it] 70%|███████   | 40/57 [01:16<00:27,  1.65s/it] 72%|███████▏  | 41/57 [01:18<00:26,  1.65s/it] 74%|███████▎  | 42/57 [01:20<00:25,  1.71s/it] 75%|███████▌  | 43/57 [01:22<00:24,  1.76s/it] 77%|███████▋  | 44/57 [01:23<00:22,  1.75s/it] 79%|███████▉  | 45/57 [01:25<00:20,  1.72s/it] 81%|████████  | 46/57 [01:27<00:18,  1.69s/it] 82%|████████▏ | 47/57 [01:29<00:17,  1.74s/it] 84%|████████▍ | 48/57 [01:31<00:16,  1.83s/it] 86%|████████▌ | 49/57 [01:32<00:14,  1.77s/it] 88%|████████▊ | 50/57 [01:34<00:11,  1.69s/it] 89%|████████▉ | 51/57 [01:35<00:10,  1.70s/it] 91%|█████████ | 52/57 [01:37<00:08,  1.67s/it] 93%|█████████▎| 53/57 [01:39<00:06,  1.67s/it] 95%|█████████▍| 54/57 [01:41<00:05,  1.71s/it] 96%|█████████▋| 55/57 [01:42<00:03,  1.74s/it] 98%|█████████▊| 56/57 [01:44<00:01,  1.76s/it]100%|██████████| 57/57 [01:46<00:00,  1.71s/it]100%|██████████| 57/57 [01:46<00:00,  1.87s/it]
Total: 1821
10/21/2022 04:41:07 - INFO - __main__ -     bleu-4 = 31.51 
10/21/2022 04:41:07 - INFO - __main__ -     ********************
10/21/2022 04:41:07 - INFO - __main__ -   Test file: /raid/cs21mtech12001/Research/Notebooks_Dataset/splitted_data/competition_notebooks_with_atleast_1_medal_and_10_votes/with_spacy_summarization/all_constraints/todo-18/test_dataset.jsonl
  0%|          | 0/1755 [00:00<?, ?it/s]  1%|          | 15/1755 [00:00<00:12, 144.43it/s]  2%|▏         | 30/1755 [00:00<00:11, 144.32it/s]  3%|▎         | 57/1755 [00:00<00:08, 200.08it/s]  5%|▍         | 81/1755 [00:00<00:07, 213.61it/s]  7%|▋         | 115/1755 [00:00<00:06, 255.53it/s]  8%|▊         | 148/1755 [00:00<00:05, 277.91it/s] 10%|█         | 179/1755 [00:00<00:05, 288.19it/s] 12%|█▏        | 208/1755 [00:00<00:05, 257.95it/s] 13%|█▎        | 235/1755 [00:00<00:06, 244.69it/s] 15%|█▌        | 265/1755 [00:01<00:05, 258.88it/s] 17%|█▋        | 296/1755 [00:01<00:05, 273.11it/s] 19%|█▊        | 328/1755 [00:01<00:04, 286.51it/s] 20%|██        | 358/1755 [00:01<00:05, 243.01it/s] 22%|██▏       | 384/1755 [00:01<00:07, 176.90it/s] 23%|██▎       | 407/1755 [00:01<00:07, 186.91it/s] 25%|██▍       | 433/1755 [00:01<00:06, 203.51it/s] 26%|██▋       | 462/1755 [00:02<00:05, 222.76it/s] 28%|██▊       | 488/1755 [00:02<00:05, 231.63it/s] 30%|██▉       | 519/1755 [00:02<00:04, 250.12it/s] 31%|███       | 546/1755 [00:02<00:04, 254.82it/s] 33%|███▎      | 578/1755 [00:02<00:04, 271.69it/s] 35%|███▍      | 606/1755 [00:02<00:04, 256.65it/s] 36%|███▌      | 633/1755 [00:02<00:04, 254.40it/s] 38%|███▊      | 659/1755 [00:02<00:04, 240.91it/s] 39%|███▉      | 684/1755 [00:02<00:04, 236.14it/s] 40%|████      | 708/1755 [00:03<00:04, 222.33it/s] 42%|████▏     | 731/1755 [00:03<00:04, 216.87it/s] 43%|████▎     | 760/1755 [00:03<00:04, 235.59it/s] 45%|████▍     | 786/1755 [00:03<00:04, 241.74it/s] 47%|████▋     | 818/1755 [00:03<00:03, 262.31it/s] 48%|████▊     | 845/1755 [00:03<00:03, 236.89it/s] 50%|████▉     | 870/1755 [00:03<00:03, 239.15it/s] 51%|█████     | 899/1755 [00:03<00:03, 250.29it/s] 53%|█████▎    | 925/1755 [00:03<00:03, 249.83it/s] 54%|█████▍    | 952/1755 [00:03<00:03, 248.56it/s] 56%|█████▌    | 978/1755 [00:04<00:03, 244.80it/s] 57%|█████▋    | 1003/1755 [00:04<00:03, 235.15it/s] 59%|█████▊    | 1029/1755 [00:04<00:03, 241.23it/s] 60%|██████    | 1054/1755 [00:04<00:02, 234.22it/s] 61%|██████▏   | 1078/1755 [00:04<00:02, 225.94it/s] 63%|██████▎   | 1110/1755 [00:04<00:02, 252.00it/s] 65%|██████▍   | 1140/1755 [00:04<00:02, 265.31it/s] 66%|██████▋   | 1167/1755 [00:04<00:02, 249.35it/s] 68%|██████▊   | 1195/1755 [00:04<00:02, 255.89it/s] 70%|██████▉   | 1224/1755 [00:05<00:02, 263.37it/s] 71%|███████▏  | 1251/1755 [00:05<00:01, 258.17it/s] 73%|███████▎  | 1280/1755 [00:05<00:01, 264.41it/s] 75%|███████▍  | 1310/1755 [00:05<00:01, 271.84it/s] 76%|███████▋  | 1341/1755 [00:05<00:01, 282.38it/s] 78%|███████▊  | 1370/1755 [00:05<00:01, 278.46it/s] 80%|███████▉  | 1398/1755 [00:05<00:01, 245.97it/s] 81%|████████  | 1424/1755 [00:05<00:01, 233.63it/s] 83%|████████▎ | 1449/1755 [00:05<00:01, 235.32it/s] 84%|████████▍ | 1473/1755 [00:06<00:01, 227.89it/s] 85%|████████▌ | 1497/1755 [00:06<00:01, 216.68it/s] 87%|████████▋ | 1519/1755 [00:06<00:01, 216.27it/s] 88%|████████▊ | 1543/1755 [00:06<00:00, 221.31it/s] 89%|████████▉ | 1568/1755 [00:06<00:00, 229.22it/s] 91%|█████████ | 1597/1755 [00:06<00:00, 246.44it/s] 93%|█████████▎| 1627/1755 [00:06<00:00, 261.89it/s] 94%|█████████▍| 1655/1755 [00:06<00:00, 267.01it/s] 96%|█████████▌| 1683/1755 [00:06<00:00, 269.95it/s] 97%|█████████▋| 1711/1755 [00:07<00:00, 264.76it/s] 99%|█████████▉| 1739/1755 [00:07<00:00, 267.38it/s]100%|██████████| 1755/1755 [00:07<00:00, 243.82it/s]
  0%|          | 0/55 [00:00<?, ?it/s]  2%|▏         | 1/55 [00:01<01:44,  1.93s/it]  4%|▎         | 2/55 [00:03<01:29,  1.69s/it]  5%|▌         | 3/55 [00:05<01:26,  1.65s/it]  7%|▋         | 4/55 [00:06<01:22,  1.63s/it]  9%|▉         | 5/55 [00:08<01:22,  1.64s/it] 11%|█         | 6/55 [00:10<01:23,  1.70s/it] 13%|█▎        | 7/55 [00:11<01:20,  1.68s/it] 15%|█▍        | 8/55 [00:13<01:17,  1.65s/it] 16%|█▋        | 9/55 [00:15<01:19,  1.74s/it] 18%|█▊        | 10/55 [00:16<01:13,  1.64s/it] 20%|██        | 11/55 [00:18<01:13,  1.68s/it] 22%|██▏       | 12/55 [00:20<01:13,  1.71s/it] 24%|██▎       | 13/55 [00:21<01:10,  1.67s/it] 25%|██▌       | 14/55 [00:23<01:08,  1.67s/it] 27%|██▋       | 15/55 [00:24<01:04,  1.62s/it] 29%|██▉       | 16/55 [00:26<01:04,  1.66s/it] 31%|███       | 17/55 [00:28<01:03,  1.68s/it] 33%|███▎      | 18/55 [00:29<00:59,  1.60s/it] 35%|███▍      | 19/55 [00:31<00:57,  1.61s/it] 36%|███▋      | 20/55 [00:33<00:56,  1.63s/it] 38%|███▊      | 21/55 [00:34<00:54,  1.61s/it] 40%|████      | 22/55 [00:36<00:53,  1.63s/it] 42%|████▏     | 23/55 [00:38<00:52,  1.63s/it] 44%|████▎     | 24/55 [00:39<00:50,  1.63s/it] 45%|████▌     | 25/55 [00:41<00:46,  1.56s/it] 47%|████▋     | 26/55 [00:42<00:45,  1.55s/it] 49%|████▉     | 27/55 [00:44<00:43,  1.55s/it] 51%|█████     | 28/55 [00:45<00:42,  1.56s/it] 53%|█████▎    | 29/55 [00:47<00:41,  1.58s/it] 55%|█████▍    | 30/55 [00:49<00:39,  1.60s/it] 56%|█████▋    | 31/55 [00:50<00:38,  1.59s/it] 58%|█████▊    | 32/55 [00:52<00:37,  1.61s/it] 60%|██████    | 33/55 [00:54<00:36,  1.67s/it] 62%|██████▏   | 34/55 [00:55<00:34,  1.63s/it] 64%|██████▎   | 35/55 [00:57<00:32,  1.61s/it] 65%|██████▌   | 36/55 [00:58<00:31,  1.64s/it] 67%|██████▋   | 37/55 [01:00<00:28,  1.59s/it] 69%|██████▉   | 38/55 [01:01<00:26,  1.56s/it] 71%|███████   | 39/55 [01:03<00:24,  1.55s/it] 73%|███████▎  | 40/55 [01:04<00:23,  1.57s/it] 75%|███████▍  | 41/55 [01:06<00:21,  1.56s/it] 76%|███████▋  | 42/55 [01:08<00:21,  1.62s/it] 78%|███████▊  | 43/55 [01:09<00:19,  1.60s/it] 80%|████████  | 44/55 [01:11<00:17,  1.59s/it] 82%|████████▏ | 45/55 [01:13<00:16,  1.65s/it] 84%|████████▎ | 46/55 [01:14<00:14,  1.62s/it] 85%|████████▌ | 47/55 [01:16<00:12,  1.57s/it] 87%|████████▋ | 48/55 [01:17<00:10,  1.54s/it] 89%|████████▉ | 49/55 [01:19<00:09,  1.56s/it] 91%|█████████ | 50/55 [01:20<00:07,  1.52s/it] 93%|█████████▎| 51/55 [01:22<00:06,  1.57s/it] 95%|█████████▍| 52/55 [01:24<00:04,  1.59s/it] 96%|█████████▋| 53/55 [01:25<00:03,  1.59s/it] 98%|█████████▊| 54/55 [01:27<00:01,  1.58s/it]100%|██████████| 55/55 [01:28<00:00,  1.49s/it]100%|██████████| 55/55 [01:28<00:00,  1.61s/it]
Total: 1755
10/21/2022 04:42:43 - INFO - __main__ -     bleu-4 = 30.3 
10/21/2022 04:42:43 - INFO - __main__ -     ********************
